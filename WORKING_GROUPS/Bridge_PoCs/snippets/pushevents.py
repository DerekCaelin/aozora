from json2html import *
import requests
import json

event_json = [{"title":"TestOfferForPushingEvent","desc":"","is_free":True,"meeting_link":""},{"title":"testevent2","desc":"testing event2","is_free":True,"meeting_link":"https://jitsi.modular.im/testmeetingfortestevent"},{"title":"test3's wish(7)","desc":"testing","is_free":True,"meeting_link":"https://jitsi.modular.im/testmeetingfortestevent"},{"title":"testoffer1","desc":"tesing offer","is_free":True,"meeting_link":"https://www.google.com"}]

event_html_string = json2html.convert(json = event_json[1], clubbing=False, escape=True)
# print(event_string)

new_html = "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01//EN\"\n   \"http://www.w3.org/TR/html4/strict.dtd\">\n<!--\ngenerated by Pygments <https://pygments.org/>\nCopyright 2006-2021 by the Pygments team.\nLicensed under the BSD license, see LICENSE for details.\n-->\n<html>\n<head>\n  <title></title>\n  <meta http-equiv=\"content-type\" content=\"text/html; charset=None\">\n  <style type=\"text/css\">\n/*\ngenerated by Pygments <https://pygments.org/>\nCopyright 2006-2021 by the Pygments team.\nLicensed under the BSD license, see LICENSE for details.\n*/\npre { line-height: 125%; }\ntd.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }\nspan.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }\ntd.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }\nspan.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }\nbody .hll { background-color: #ffffcc }\nbody { background: #ffffff; }\nbody .c { color: #888888; font-style: italic } /* Comment */\nbody .err { color: #FF0000 } /* Error */\nbody .k { color: #0000ff } /* Keyword */\nbody .n { color: #000000 } /* Name */\nbody .ch { color: #888888; font-style: italic } /* Comment.Hashbang */\nbody .cm { color: #888888; font-style: italic } /* Comment.Multiline */\nbody .cp { color: #888888; font-style: italic } /* Comment.Preproc */\nbody .cpf { color: #888888; font-style: italic } /* Comment.PreprocFile */\nbody .c1 { color: #888888; font-style: italic } /* Comment.Single */\nbody .cs { color: #888888; font-style: italic } /* Comment.Special */\nbody .kc { color: #0000ff } /* Keyword.Constant */\nbody .kd { color: #0000ff } /* Keyword.Declaration */\nbody .kn { color: #0000ff } /* Keyword.Namespace */\nbody .kp { color: #0000ff } /* Keyword.Pseudo */\nbody .kr { color: #0000ff } /* Keyword.Reserved */\nbody .kt { color: #0000ff } /* Keyword.Type */\nbody .m { color: #33aaff } /* Literal.Number */\nbody .s { color: #55aa22 } /* Literal.String */\nbody .na { color: #000000 } /* Name.Attribute */\nbody .nb { color: #000000 } /* Name.Builtin */\nbody .nc { color: #000000 } /* Name.Class */\nbody .no { color: #000000 } /* Name.Constant */\nbody .nd { color: #000000 } /* Name.Decorator */\nbody .ni { color: #000000 } /* Name.Entity */\nbody .ne { color: #000000 } /* Name.Exception */\nbody .nf { color: #000000 } /* Name.Function */\nbody .nl { color: #000000 } /* Name.Label */\nbody .nn { color: #000000 } /* Name.Namespace */\nbody .nx { color: #000000 } /* Name.Other */\nbody .py { color: #000000 } /* Name.Property */\nbody .nt { color: #000000 } /* Name.Tag */\nbody .nv { color: #000000 } /* Name.Variable */\nbody .ow { color: #0000ff } /* Operator.Word */\nbody .mb { color: #33aaff } /* Literal.Number.Bin */\nbody .mf { color: #33aaff } /* Literal.Number.Float */\nbody .mh { color: #33aaff } /* Literal.Number.Hex */\nbody .mi { color: #33aaff } /* Literal.Number.Integer */\nbody .mo { color: #33aaff } /* Literal.Number.Oct */\nbody .sa { color: #55aa22 } /* Literal.String.Affix */\nbody .sb { color: #55aa22 } /* Literal.String.Backtick */\nbody .sc { color: #55aa22 } /* Literal.String.Char */\nbody .dl { color: #55aa22 } /* Literal.String.Delimiter */\nbody .sd { color: #55aa22 } /* Literal.String.Doc */\nbody .s2 { color: #55aa22 } /* Literal.String.Double */\nbody .se { color: #55aa22 } /* Literal.String.Escape */\nbody .sh { color: #55aa22 } /* Literal.String.Heredoc */\nbody .si { color: #55aa22 } /* Literal.String.Interpol */\nbody .sx { color: #55aa22 } /* Literal.String.Other */\nbody .sr { color: #55aa22 } /* Literal.String.Regex */\nbody .s1 { color: #55aa22 } /* Literal.String.Single */\nbody .ss { color: #55aa22 } /* Literal.String.Symbol */\nbody .bp { color: #000000 } /* Name.Builtin.Pseudo */\nbody .fm { color: #000000 } /* Name.Function.Magic */\nbody .vc { color: #000000 } /* Name.Variable.Class */\nbody .vg { color: #000000 } /* Name.Variable.Global */\nbody .vi { color: #000000 } /* Name.Variable.Instance */\nbody .vm { color: #000000 } /* Name.Variable.Magic */\nbody .il { color: #33aaff } /* Literal.Number.Integer.Long */\n\n  </style>\n</head>\n<body>\n<h2></h2>\n\n<div class=\"highlight\"><pre><span></span><span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;hello, tuna78&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</body>\n</html>\n"


#CURL part
url = "https://matrix.org/_matrix/client/r0/rooms/!pGknCOjcLlodAZYwdl:matrix.org/send/m.room.message"
payload = {"body": "","format": "org.matrix.custom.html","formatted_body": '' +event_html_string+ '',"msgtype": "m.text"}
# print(payload["formatted_body"])
headers = {"Authorization": "Bearer syt_dHVuYTc4_igTRRcUtwTVDeaeFJNxk_26pf9i"}
res = requests.post(url, data=json.dumps(payload), headers=headers)
print(res.text)
print(res.status_code)